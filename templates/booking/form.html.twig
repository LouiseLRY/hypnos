{% extends 'base.html.twig' %}

{% block stylesheets %}
{{ parent() }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
{% endblock %}

{% block title %}Hypnos Hôtels - Réserver{% endblock %}

{% block content %}
    <div class="heading-page">
        <h2>Réservez-votre séjour</h2>
    </div>
    <div class="container frame">
        <div class="row">
            <div class="col text-center">
                <img class="img-fluid" src="{{ asset('assets/images/breakfast.png') }}" alt="Notre petit déjeuner
                continental"
                     width="500">
            </div>
        </div>
        <div class="row">
            <div class="col-6 mt-5">
                {{ form_start(form) }}
                {{ form_row(form.establishment) }}
                <div class="my-5"></div>
                {{ form_row(form.dateStart) }}
            </div>
            <div class="col-6 mt-5">
                {{ form_row(form.suite) }}
                <div class="my-5"></div>
                {{ form_row(form.dateEnd) }}
            </div>
        </div>
        <div class="row">
            <div class="col">
            {{ form_end(form) }}
            </div>
        </div>
    </div>
{% endblock %}

 {% block javascripts %}
     {{ parent() }}

     <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.js"></script>
     <script>
         $(document).ready(function() {
             // you may need to change this code if you are not using Bootstrap Datepicker
             $('.js-datepicker').datepicker({
                 format: 'yyyy-mm-dd'
             });

         // Getting the suites according to the chosen establishment
         let establishment = $('#booking_establishment');
         // When establishment gets selected ...
         establishment.change(function() {
             // ... retrieve the corresponding form.
             let form = $(this).closest('form');
             // Simulate form data, but only include the selected establishment value.
             let data = {};
             data[establishment.attr('name')] = establishment.val();

             // Submit data via AJAX to the form's action path.
             $.ajax({
                 url : form.attr('action'),
                 type: form.attr('method'),
                 data : data,
                 complete: function(html) {
                     $('#booking_suite').replaceWith(
                         $(html.responseText).find('#booking_suite')
                     );
             let suiteSelect = document.querySelector('#booking_suite');

             // Getting the value of the option every time the user clicks to change it
             suiteSelect.addEventListener("change", function(){
                 let chosenSuite = suiteSelect.options[suiteSelect.selectedIndex].value;
                 // Sending that variable through a cookie
                 createCookie("suite", chosenSuite, "1")
             })
                 }
             });

             //Creating the cookie to send the variable to the backend
             function createCookie(name, value, days) {
                 let expires;

                 if (days) {
                     let date = new Date();
                     date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                     expires = "; expires=" + date.toGMTString();
                 }
                 else {
                     expires = "";
                 }

                 document.cookie = escape(name) + "=" +
                     escape(value) + expires + "; path=/";
             }
         });



         });
     </script>D

 {% endblock %}
